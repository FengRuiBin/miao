<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>moving-box</title>
  <style>
    div {
      position: absolute;
    }
  </style>
</head>

<body>
  <div id="J" style="top: 100px; left: 100px;">
    <img src="./杰瑞.png" alt="Jerry" width="120px" height="120px">
  </div>
  <div id="T" style="top: 50px; left: 800px;">
    <img src="./汤姆.jpeg" alt="Tom" width="500px" height="300px">
  </div>
  <script>
    let J = document.querySelector('#J')
    let T = document.querySelector('#T')
    let Jerry = {
      vx: 0,
      vy: 0,
      leftPress: false,
      rightPress: false,
      upPress: false,
      downPress: false
    }
    let Tom = {
      vx: 0,
      vy: 0,
      leftPress: false,
      rightPress: false,
      upPress: false,
      downPress: false
    }
    document.addEventListener('keydown', function (e) {
      if (e.key == 'ArrowRight') {//向右
        Jerry.vx = 1
        Jerry.rightPress = true
      }
      if (e.key == 'ArrowLeft') {//向左
        Jerry.vx = -1
        Jerry.leftPress = true
      }
      if (e.key == 'ArrowUp') {//向上
        Jerry.vy = -1
        Jerry.upPress = true
      }
      if (e.key == 'ArrowDown') {//向下
        Jerry.vy = 1
        Jerry.downPress = true
      }
      if (e.keyCode == 68) {
        Tom.vx = 1
        Tom.rightPress = true
      }
      if (e.keyCode == 65) {
        Tom.vx = -1
        Tom.leftPress = true
      }
      if (e.keyCode == 87) {
        Tom.vy = -1
        Tom.upPress = true
      }
      if (e.keyCode == 83) {
        Tom.vy = 1
        Tom.downPress = true
      }
    })
    document.addEventListener('keyup', function (e) {
      if (e.key == 'ArrowRight') {
        Jerry.rightPress = false
        if (Jerry.leftPress) {
          Jerry.vx = -1
        } else {
          Jerry.vx = 0
        }
      }
      if (e.key == 'ArrowLeft') {
        Jerry.leftPress = false
        if (Jerry.rightPress) {
          Jerry.vx = 1
        } else {
          Jerry.vx = 0
        }
      }
      if (e.key == 'ArrowUp') {
        Jerry.upPress = false
        if (Jerry.downPress) {
          Jerry.vy = 1
        } else {
          Jerry.vy = 0
        }
      }
      if (e.key == 'ArrowDown') {
        Jerry.downPress = false
        if (Jerry.upPress) {
          Jerry.vy = -1
        } else {
          Jerry.vy = 0
        }
      }
      if (e.keyCode == 68) {
        Tom.rightPress = false
        if (Tom.leftPress) {
          Tom.vx = -1
        } else {
          Tom.vx = 0
        }
      }
      if (e.keyCode == 65) {
        Tom.leftPress = false
        if (Tom.rightPress) {
          Tom.vx = 1
        } else {
          Tom.vx = 0
        }
      }
      if (e.keyCode == 87) {
        Tom.upPress = false
        if (Tom.downPress) {
          Tom.vy = 1
        } else {
          Tom.vy = 0
        }
      }
      if (e.keyCode == 83) {
        Tom.downPress = false
        if (Tom.upPress) {
          Tomn.vy = -1
        } else {
          Tom.vy = 0
        }
      }
    })


    let lastTime = 0
    requestAnimationFrame(function move(time) {
      let timeDiff = time - lastTime
      lastTime = time
      J.style.left = parseFloat(J.style.left) + Jerry.vx * timeDiff * 0.3 + 'px'
      J.style.top = parseFloat(J.style.top) + Jerry.vy * timeDiff * 0.3 + 'px'
      T.style.left = parseFloat(T.style.left) + Tom.vx * timeDiff * 0.3 + 'px'
      T.style.top = parseFloat(T.style.top) + Tom.vy * timeDiff * 0.3 + 'px'
      requestAnimationFrame(move)
    })
  </script>
</body>

</html>